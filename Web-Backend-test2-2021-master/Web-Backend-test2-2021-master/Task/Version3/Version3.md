# Контрольная 2, вариант 3

## Задача
Ваша задача заключается в необходимости разработать вебсайт для системы CodeHedgehog.
В задании необходимо использовать EF для работы с БД, а также MS Identity для работы с пользователями и их ролями. 

В системе должны присутствовать следующие роли: 
* Студент
* Преподаватель 
* Админ

Неавторизованный пользователь может просматривать: 
* Список тем
* Список задач
* Конкретную задачу

### Функционал на страницах
Перед прочтением следующих секций задания стоит понимать, что оно составлялось с учётом модульного принципа - вы сами решаете, что в задании делать, а что нет. Не нужно выполнять все требования для каждой страницы. Если что-то даётся слишком тяжело - пропускайте. 
#### Страница "Авторизация/Регистрация"
Шаблоны для данных страниц не предоставлены - используем родные от Identity, они уже присутствуют в проекте. См контроллер ```AccountController```. Если у пользователя нет прав доступа по причине того, что он не вошёл в систему - стоит сразу перенаправлять на страницу логина. 

Пользователь может редактировать свой профиль.

#### Страница "Список пользователей"
На данной странице выводится список пользоателей (пока, вроде, очевидно). При этом присутствует возможность фильтровать пользователей по части имени, Email и роли. Как было написано ранее - вы сами выбираете, что делать из задания. Вы можете пропустить функционал фильтрации и просто выводить общий список пользователей. 

Страница пользователя отсутствует, доступно только редактирование и удаление. Для редактирования и удаления можно использовать автосгенерированные страницы (Нет требований к макету этих страниц)

**Доступ на данную страницу, а также на редактирование и удаление пользователя должен иметь только администратор**. 

#### Страница "Задачи"
На странице со списком задач также присутствует блок с фильтрацией, который вы можете не реализовывать, если вам слишком сложно. Обязательно оцените его трудоёмкость и посмотрите, сколько баллов даст его выполнение. 

Если использование плагина Select2 вам усложняет работу (хотя он уже подключен в макете и длполнительно на стороне backend ничего не нужно делать для его использования) можете его отключить, это повлияет только на аспекцт оценивания, посвящённый корректности использования макетов. 

Общее количество набранных балов считается из суммы стоимостей задач, у которых статус для пользователя == OK (то есть задача сдана и прошла проверку учителя).

Название и тема задачи являются кликабельными. Необходимость постмодерации отображается наличием или отсутствием галочки. Если постмодерация не является необходимой (галочка снята), то при отправке задачи пользователем она сразу получает статус OK. 

Действия: 
* "Отправить решение" доступно любому авторизованному пользователю. 
* "Подробности" доступно любому пользователю - ведёт на страницу задачи, также как и имя задачи. 
* "Удалить" доступно только администратору. 

Если реализована фильтрация по теме, то допускается один из двух подходов: 
* Выводятся задачи только с указанной темой (темами. В макете представлен select со множественным выбором. Если слишком сложно, отключите аттрибут множественного выбора).
* Выводятся задачи, у которой тема или указанная в фильтре, или любая из потомков (дочерний элемент, дочерний элемент дочернего элемента и т.д.). **Данный вариант гораздо сложнее** и стоит больше. 

#### Страница "Темы"
На данной странице выводится список тем. Создавать, редактировать, удалять темы может только администратор. Просматривать темы может кто угодно. 

При нажатии на кнопку "задачи темы" должна открываться страница со списком задач, на которой выбран фильтр по теме. 

У каждой темы может быть (или не быть) родительская тема. Тем самым мы имеем набор деревьев тем без ограничения глубины. 

Данная страница доступна всем пользователям. 

#### Страница "Создать задачу"
Данная страница состоит из формы создания задачи. Для входного и выходного файла должна быть реализована проверка, которая считает валидным тольк офайл с расширением ```.txt``` и размером меньше 1мб. 
На странице используется текстовый редактор. Если по какой-то причине он вам мешает - можете его отключить. При использовании текстового редактора на сервер при отправке формы отправляется HTML введённого текста, то есть тип данных не меняется и остаётся ```string```. 

Все поля являются обязательными. 

Данная страница доступна только админу или преподавателю. 

#### Страница "Просмотр задачи"
Страница просмотра задачи состоит из вывода: 
* Имени задачи. 
* Стоимости. 
* Условий. 
* Кнопки "отправить решение", которая переводит пользователя на страницу отправки решения на данную задачу. 

Все остальные данные являются статичными. 

Страница доступна всем авторизованным пользователям. 

#### Страница "Отправить решение"
Существует только в контексте задачи, для которой отправляется решение. Имя задачи является кликабельным. 

Страница доступна всем авторизованным пользователям. 

#### Страница "Очередь постмодерации"
На странице со списком решений также присутствует блок с фильтрацией, который вы можете не реализовывать, если вам слишком сложно. Обязательно оцените его трудоёмкость и посмотрите, сколько баллов даст его выполнение. 

Если реализована фильтрация по теме, то допускается один из двух подходов: 
* Выводятся задачи только с указанной темой (темами. В макете представлен select со множественным выбором. Если слишком сложно, отключите аттрибут множественного выбора).
* Выводятся задачи, у которой тема или указанная в фильтре, или любая из потомков (дочерний элемент, дочерний элемент дочернего элемента и т.д.). **Данный вариант гораздо сложнее** и стоит больше. 

Существует 3 вердикта:
* Pending - Стоит по-умолчанию, если только на задаче не убрана обязательная постмодерация. Означает, что преподаватель ещё не проверил задачу. 
* OK - означает, что преподаватель проверил задачу и она прошла проверку. Выставляется автоматически, если у задачи убрана обязательная постмодерация. 
* Declined - означает, что преподаватель проверил задачу и она не прошла проверку.

Кнопка "модерировать" открывает страницу, где решению выставляется вердикт. 

В фильтрах "тема", "язык" и "пользователь" являются select'ом со множественным выбором. 

Студент видит только свои решения, администратор и преподаватель все отправленные решения. Анонимному пользователю доступ закрыт. 

#### Страница "Детали постмодерации"
На данной странице выводится код решения пользователя, а также даётся выбор вердикта учителя. 
Данная страница доступна только админу или преподавателю.


### Прочие условия
1. У вас в системе должны создаваться (через код) пользователь-админ и пользователь-преподаватель. То есть на момент проверки они должны появиться в БД и данные для входа я должен найти в вашем коде. 
2. В имени БД (в строке подключения) допишите в конец вашу фамилию, это сильно упростит проверку ваших решений. 
3. Если макета для какой-то страницы нет - используйте автосгенерированные страницы (как в лабораторных).   
4. Боковое меню должно быть функциональным. 
5. В большей части макетов уже заготовлены операторы ветвленяи с комментариями, какую проверку необходимо реализовать в указанном месте. Вы можете менять код представлений как угодно, чтобы выполнить поставленные задачи. Главное старатсья не влиять на визуальное оформление. 
6. Не застревайте на раелизации вещей, которые не получается сделать и которые отнимают время. Пробуйте сделать хотя бы лёгкие задачи. 
7. Сущности должны храниться в БД. Исключение - Языки программирования, статусы у задач. 
8. Приветствуется (с бонусом в виде баллов) автоматическое создание тестовых сущностей кроме пользователей из кода (задачи, темы, решения). 

## Оценивание
Оцениваемые аспекты: 
1. Автоматически созданные пользователи с тремя видами ролей (студент, преподаватель, админ). Стоимость: 0,25. 
2. Авторизация, регистрация, выход. Стоимость: 0,25. 
3. На главной странице открывается список задач или решений на проверку. Стоимость: 0,15.
4. [Список пользователей] Выводится список пользователей (из БД). Стоимость: 0,5.
5. [Список пользователей] Пользователь удаляется. Стоимость: 0,25.
6. [Список пользователей] Пользователь редактируется (админом и самим пользователем. Пользователь переходит на редактирвоание через иконку профиля в шапке). Стоимость: 0,25.
7. [Список пользователей] Работает фильтр по Имени, Email, Роли. Стоимость: 0,75.
8. [Список пользователей] Работает проверка доступа. Стоимость: 0,2.
8. [Список задач] Выводится список задач. Стоимость: 0,5.
9. [Список задач] Работает удаление задачи. Стоимость: 0,25.
10. [Список задач] Корректн оподсчитывается и выводится сумма набранных пользователем баллов. Стоимость: 0,5.
11. [Список задач] Работает фильтр по Названию и теме. Стоимость: 0,5. 
12. [Список задач] Работает фильтр по теме с учётом задач в выбранной теме, а также всех подтемах. Стоимость: 0,75.
13. [Список задач] Корректно выставляется значение статуса задачи для авторизованного пользователя (например ```data-title="Не решено"```). Стоимость: 0,15.
15. [Список задач] Работает проверка доступа. Стоимость: 0,25.
14. [Список тем] Выводится список тем. Стоимость: 0,25.
15. [Список тем] Тема создаётся. Стоимость: 0,25. 
16. [Список тем] Работает переход на страницу со списком задач с установкой фильтра по теме (Фильтр не обязан для этого работать). Стоимость: 0,25.
17. [Список тем] Тема удаляется. Стоимость: 0,25. 
18. [Список тем] Тема редактируется. Стоимость: 0,25.
21. [Список тем] Работает проверка доступа. Стоимость: 0,25.
19. [Создание задачи] Задача создаётся (без файлов). Стоимость:  0,25.
20. [Создание задачи] При создании задачи работает добавление файлов (с проверками). Стоимость: 0,5.
21. [Создание задачи] При переходе к задачам через кнопку "назад к списку" настройи фильтрации сохраняются (фильтры не обязаны быть для этого реализованы). Стоимость: 0,15.
23. [Создание задачи] Работает проверка доступа. Стоимость:  0,25.
22. [Просмотр задачи] Данные выводятся корректно. Стоимость: 0,25.
23. [Отправка решения] Решение отправляется. Стоимость: 0,25. 
24. [Отправка решения] Работает проверка доступа. Стоимость: 0,25.
25. [Очередь постмодерации] Работает фильтрация. Стоимость: 1.
26. [Очередь постмодерации] Работает фильтр по теме с учётом задач в выбранной теме, а также всех подтемах. Стоимость: 0,75.
31. [Очередь постмодерации] Выводится список решений. Стоимость: 0,25. 
32. [Очередь постмодерации] Решение удаляется. Стоимость: 0,25. 
33. [Очередь постмодерации] Работает проверка доступа и вывод решений соответствующий уровню доступа. Стоимость: 0,5 
34. [Постмодерация] Данные выводятся корректно. Стоимость: 0,15. 
35. [Постмодерация] Вердикт меняется. Стоимость: 0,2.  
36. Бонус за архитектуру. Стоимость 1. 
37. Бонус за использвоание макетов ("похожесть" на макет. Учитывается и то, что ссылки в сайдбаре функционируют, как положено). Стоимость: 0,5. 

**Итого: 13,5**